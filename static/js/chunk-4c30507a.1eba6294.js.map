{"version":3,"sources":["webpack:///./src/assets/images/userBanner.png","webpack:///./src/views/user/index.vue?db12","webpack:///./src/views/user/index.vue","webpack:///./src/views/user/index.vue?e3ea"],"names":["module","exports","class","_createElementVNode","src","_imports_0","alt","_imports_1","_createElementBlock","_createVNode","_component_HeadTop","title","isShowTop","isSubHeader","_hoisted_2","_toDisplayString","_ctx","_hoisted_7","_hoisted_10","onClick","_Fragment","_renderList","item","index","key","_hoisted_19","components","HeadTop","setup","store","useStore","useI18n","t","data","reactive","address","computed","state","accounts","web3","provider","freeDomContract","usdtContract","nftContract","freeDomBalance","usdtBalance","reward","list","nftNum","initContract","eth","Contract","tokenAbi","config","usdtAddress","freeDomAddress","nftAbi","nftAddress","initData","getBalance","getRewardAmount","getNft","methods","balanceOf","call","BigNumber","dividedBy","toFixed","getUserAllTokens","ids","length","earned","withdrawReward","getReward","send","from","Toast","watch","val","refData","toRefs","__exports__","render"],"mappings":"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","file":"static/js/chunk-4c30507a.1eba6294.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/userBanner.3ce66322.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=62bfe80a&lang=less&scoped=true\"","<template>\n  <div class=\"user-box\">\n    <HeadTop title=\"我的资产\" :isShowTop=\"true\" :isSubHeader=\"false\"></HeadTop>\n    <div class=\"top-banner\">\n      <img src=\"@/assets/images/userBanner.png\" alt=\"\">\n    </div>\n    <div class=\"user-item\">\n      <div class=\"title\"> {{$t('index.我的代币资产')}}</div>\n      <div class=\"token-box flex-between\">\n        <div class=\"token-item\">\n        <div class=\"name\">USDT</div>\n        <div class=\"num\">{{usdtBalance}}</div>\n      </div>\n      <div class=\"token-item\">\n        <div class=\"name\">FreeDom</div>\n        <div class=\"num\">{{freeDomBalance}}</div>\n      </div>\n      </div>\n    </div>\n\n     <div class=\"user-item\">\n      <div class=\"title\"> {{$t('index.自由联盟勋章')}}({{nftNum}})</div>\n      <div class=\"mynft-box\">\n        <div class=\"mynft-item flex-middle\">\n          <div class=\"desc-box flex-item\">\n            <div class=\"name\"> {{$t('index.待领取收益')}}</div>\n            <div class=\"num\"> {{$t('index.收益:')}} {{reward}}FreeDom</div>\n          </div>\n          <div class=\"get-btn\" @click=\"withdrawReward\"> {{$t('index.领取')}}</div>\n      </div>\n      <div class=\"mynft-item flex-middle\" v-for=\"(item, index) in list\" :key=\"index\">\n         <img src=\"@/assets/images/logo.png\" alt=\"\">\n          <div class=\"desc-box flex-item\">\n            <div class=\"name\">FreeDom #{{item}}</div>\n          </div>\n      </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport HeadTop from '@/components/HeadTop'\nimport { reactive, toRefs, computed, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nimport config from \"@/utils/config\";\nimport tokenAbi from \"@/utils/abi\";\nimport nftAbi from \"@/utils/nftAbi\";\nimport { useI18n } from \"vue-i18n\"\n\nimport BigNumber from 'bignumber.js';\nimport { Toast } from 'vant';\n\n\nexport default {\n  components: {\n    HeadTop\n  },\n  setup () {\n    const store = useStore()\n    const { t } = useI18n()\n    const data = reactive({\n      address: computed(() => store.state.accounts[0]),\n      web3: computed(() => store.state.provider),\n      freeDomContract: null,\n      usdtContract: null,\n      nftContract: null,\n      freeDomBalance: '0.00',\n      usdtBalance: '0.00',\n      reward: '0.00',\n      list: [],\n      nftNum: 0,\n      initContract: () => {\n        data.usdtContract = new data.web3.eth.Contract(tokenAbi, config.usdtAddress)\n        data.freeDomContract = new data.web3.eth.Contract(tokenAbi, config.freeDomAddress)\n        data.nftContract = new data.web3.eth.Contract(nftAbi, config.nftAddress)\n        data.initData()\n      },\n      initData: () => {\n        data.getBalance()\n        data.getRewardAmount()\n        data.getNft()\n      },\n       getBalance: async () => {\n        let freeDomBalance = await data.freeDomContract.methods.balanceOf(data.address).call()\n        let usdtBalance = await data.usdtContract.methods.balanceOf(data.address).call()\n        data.usdtBalance =  new BigNumber(usdtBalance).dividedBy(10 ** 18).toFixed(2,1)\n        data.freeDomBalance =  new BigNumber(freeDomBalance).dividedBy(10 ** 18).toFixed(2,1)\n      },\n      getNft: async () => {\n        let ids = await data.nftContract.methods.getUserAllTokens(data.address).call()\n        data.nftNum = ids.length\n        data.list = ids\n        console.log(ids)\n      },\n      getRewardAmount: async () => {\n        let reward = await data.nftContract.methods.earned(data.address).call()\n        data.reward = new BigNumber(reward).dividedBy(10 ** 18).toFixed(3)\n      },\n      withdrawReward: async () => {\n         try {\n          await data.nftContract.methods.getReward().send({from: data.address})\n          Toast(t('index.领取成功'))\n           data.initData()\n        } catch (error) {\n          Toast(t('index.领取失败'))\n        }\n      }\n    })\n    if (data.address) {\n      data.initContract()\n    }\n    watch(() => data.address, (val) => {\n      if (val) {\n        data.initContract()\n      }\n    })\n    const refData = toRefs(data);\n    return {\n      ...refData\n    };\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.user-box{\n  padding: 20px 16px 15px;\n  .top-banner{\n    // padding: 16px;\n    // background: url('~@/assets/images/item_bg.png') no-repeat;\n    // background-size: cover;\n    img{\n      display: block;\n      width: 100%;\n    }\n    border-radius: 4px;\n    margin-bottom: 30px;\n    .title{\n      font-size: 23px;\n      color: #fff;\n      font-weight: 600;\n      margin-bottom: 5px;\n    }\n    .desc{\n      font-size: 14px;\n      color: rgba(255, 255, 255, 0.55);\n      margin-bottom: 15px;\n    }\n    .span-btn{\n      height: 22px;\n      line-height: 22px;\n      font-size: 10px;\n      background: linear-gradient(0deg, rgba(255, 255, 255, 0.8) 0%, #FFFFFF 100%);\n      color: #F03C85;\n      padding: 0 10px;\n      border-radius: 12px;\n      display: inline-block;\n    }\n  }\n  .user-item{\n    margin-bottom: 24px;\n    .title{\n      font-size: 16px;\n      color: #fff;\n      font-weight: 600;\n      margin-bottom: 14px;\n      position: relative;\n      padding-left: 10px;\n      &::after{\n        content: '';\n        width: 3px;\n        position: absolute;\n        height: 100%;\n        left: 0;\n        background: #66d304;\n      }\n    }\n    .token-box{\n      flex-wrap: wrap;\n    }\n    .token-item{\n      padding: 20px;\n      color: #fff;\n      margin: 5px 0;\n      border-radius: 6px;\n      width: 49%;\n      .name{\n        font-size: 16px;\n        font-weight: 600;\n      }\n      .num{\n        font-weight: 600;\n        font-size: 22px;\n      }\n      &:nth-child(1) {\n        background: url('~@/assets/images/item_1.png') no-repeat;\n        background-size: cover;\n        .name{\n          color: #FFE3C8;\n        }\n      }\n      &:nth-child(2) {\n        background: url('~@/assets/images/item_2.png') no-repeat;\n        background-size: cover;\n        .name{\n          color: #C3E3FE;\n        }\n      }\n      &:nth-child(3) {\n        background: url('~@/assets/images/item_2.png') no-repeat;\n        background-size: cover;\n        .name{\n          color: #C3E3FE;\n        }\n      }\n    }\n    .nft-box{\n      background: linear-gradient(-90deg, #3C3863 0%, #4A3B76 100%);\n      border-radius: 4px;\n      padding: 0 20px;\n      flex-wrap: wrap;\n      .nft-item{\n        width: 50%;\n         padding:20px 15px;\n        .name{\n          color: #9D8BD0;\n          font-size: 14px;\n          margin-bottom: 10px;\n        }\n        .num{\n           color: #fff;\n          font-size: 18px;\n          font-weight: 600;\n        }\n      }\n    }\n    .mynft-box{\n      .mynft-item{\n        background: rgba(255, 255, 255, 0.15);\n        padding: 15px;\n        border-radius: 4px;\n        margin-bottom: 10px;\n        img{\n          width: 60px;\n          height: 60px;\n          margin-right: 12px;\n          display: block;\n        }\n        .desc-box{\n          .name{\n            font-size: 15px;\n            color: #fff;\n            font-weight: 600;\n            margin-bottom: 5px;\n          }\n          .num{\n            font-size: 14px;\n            color: #a3ed3e;\n          }\n        }\n        .get-btn{\n          background: #66d304;\n          height: 30px;\n          border-radius: 15px;\n          padding: 0 15px;\n          color: #fff;\n          line-height: 30px;\n          font-size: 13px;\n        }\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./index.vue?vue&type=template&id=62bfe80a&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=62bfe80a&lang=less&scoped=true\"\n\nimport exportComponent from \"/Users/wangyouquan/priviteProject/freeDom/freeDomVUe/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-62bfe80a\"]])\n\nexport default __exports__"],"sourceRoot":""}