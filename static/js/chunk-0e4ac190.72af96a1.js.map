{"version":3,"sources":["webpack:///./src/assets/images/userBanner.png","webpack:///./src/views/user/index.vue?7a0b","webpack:///./src/views/user/index.vue","webpack:///./src/views/user/index.vue?e3ea"],"names":["module","exports","class","_createElementVNode","src","_imports_0","alt","_imports_1","_createElementBlock","_createVNode","_component_HeadTop","title","isShowTop","isSubHeader","_hoisted_2","_toDisplayString","_ctx","_hoisted_7","_hoisted_10","onClick","_Fragment","_renderList","item","index","key","_hoisted_19","components","HeadTop","setup","store","useStore","useI18n","t","data","reactive","address","computed","state","accounts","web3","provider","freeDomContract","usdtContract","nftContract","freeDomBalance","usdtBalance","reward","list","initContract","eth","Contract","tokenAbi","config","usdtAddress","freeDomAddress","nftAbi","nftAddress","initData","getBalance","getRewardAmount","getNft","methods","balanceOf","call","BigNumber","dividedBy","toFixed","getUserAllTokens","ids","earned","withdrawReward","getReward","send","from","Toast","watch","val","refData","toRefs","__exports__","render"],"mappings":"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","file":"static/js/chunk-0e4ac190.72af96a1.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/userBanner.3ce66322.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=2bdcf2c3&lang=less&scoped=true\"","<template>\r\n  <div class=\"user-box\">\r\n    <HeadTop title=\"我的资产\" :isShowTop=\"true\" :isSubHeader=\"false\"></HeadTop>\r\n    <div class=\"top-banner\">\r\n      <img src=\"@/assets/images/userBanner.png\" alt=\"\">\r\n    </div>\r\n    <div class=\"user-item\">\r\n      <div class=\"title\"> {{$t('index.我的代币资产')}}</div>\r\n      <div class=\"token-box flex-between\">\r\n        <div class=\"token-item\">\r\n        <div class=\"name\">USDT</div>\r\n        <div class=\"num\">{{usdtBalance}}</div>\r\n      </div>\r\n      <div class=\"token-item\">\r\n        <div class=\"name\">FreeDom</div>\r\n        <div class=\"num\">{{freeDomBalance}}</div>\r\n      </div>\r\n      </div>\r\n    </div>\r\n\r\n     <div class=\"user-item\">\r\n      <div class=\"title\"> {{$t('index.我的NFT')}}</div>\r\n      <div class=\"mynft-box\">\r\n        <div class=\"mynft-item flex-middle\">\r\n          <div class=\"desc-box flex-item\">\r\n            <div class=\"name\"> {{$t('index.待领取收益')}}</div>\r\n            <div class=\"num\"> {{$t('index.收益:')}} {{reward}}FreeDom</div>\r\n          </div>\r\n          <div class=\"get-btn\" @click=\"withdrawReward\"> {{$t('index.领取')}}</div>\r\n      </div>\r\n      <div class=\"mynft-item flex-middle\" v-for=\"(item, index) in list\" :key=\"index\">\r\n         <img src=\"@/assets/images/logo.png\" alt=\"\">\r\n          <div class=\"desc-box flex-item\">\r\n            <div class=\"name\">FreeDom #{{item}}</div>\r\n          </div>\r\n      </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport HeadTop from '@/components/HeadTop'\r\nimport { reactive, toRefs, computed, watch } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport config from \"@/utils/config\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport nftAbi from \"@/utils/nftAbi\";\r\nimport { useI18n } from \"vue-i18n\"\r\n\r\nimport BigNumber from 'bignumber.js';\r\nimport { Toast } from 'vant';\r\n\r\n\r\nexport default {\r\n  components: {\r\n    HeadTop\r\n  },\r\n  setup () {\r\n    const store = useStore()\r\n    const { t } = useI18n()\r\n    const data = reactive({\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      freeDomContract: null,\r\n      usdtContract: null,\r\n      nftContract: null,\r\n      freeDomBalance: '0.00',\r\n      usdtBalance: '0.00',\r\n      reward: '0.00',\r\n      list: [],\r\n      initContract: () => {\r\n        data.usdtContract = new data.web3.eth.Contract(tokenAbi, config.usdtAddress)\r\n        data.freeDomContract = new data.web3.eth.Contract(tokenAbi, config.freeDomAddress)\r\n        data.nftContract = new data.web3.eth.Contract(nftAbi, config.nftAddress)\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        data.getBalance()\r\n        data.getRewardAmount()\r\n        data.getNft()\r\n      },\r\n       getBalance: async () => {\r\n        let freeDomBalance = await data.freeDomContract.methods.balanceOf(data.address).call()\r\n        let usdtBalance = await data.usdtContract.methods.balanceOf(data.address).call()\r\n        data.usdtBalance =  new BigNumber(usdtBalance).dividedBy(10 ** 18).toFixed(2,1)\r\n        data.freeDomBalance =  new BigNumber(freeDomBalance).dividedBy(10 ** 18).toFixed(2,1)\r\n      },\r\n      getNft: async () => {\r\n        let ids = await data.nftContract.methods.getUserAllTokens(data.address).call()\r\n        data.list = ids\r\n        console.log(ids)\r\n      },\r\n      getRewardAmount: async () => {\r\n        let reward = await data.nftContract.methods.earned(data.address).call()\r\n        data.reward = new BigNumber(reward).dividedBy(10 ** 18).toFixed(3)\r\n      },\r\n      withdrawReward: async () => {\r\n         try {\r\n          await data.nftContract.methods.getReward().send({from: data.address})\r\n          Toast(t('index.领取成功'))\r\n           data.initData()\r\n        } catch (error) {\r\n          Toast(t('index.领取失败'))\r\n        }\r\n      }\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n    watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.user-box{\r\n  padding: 20px 16px 15px;\r\n  .top-banner{\r\n    // padding: 16px;\r\n    // background: url('~@/assets/images/item_bg.png') no-repeat;\r\n    // background-size: cover;\r\n    img{\r\n      display: block;\r\n      width: 100%;\r\n    }\r\n    border-radius: 4px;\r\n    margin-bottom: 30px;\r\n    .title{\r\n      font-size: 23px;\r\n      color: #fff;\r\n      font-weight: 600;\r\n      margin-bottom: 5px;\r\n    }\r\n    .desc{\r\n      font-size: 14px;\r\n      color: rgba(255, 255, 255, 0.55);\r\n      margin-bottom: 15px;\r\n    }\r\n    .span-btn{\r\n      height: 22px;\r\n      line-height: 22px;\r\n      font-size: 10px;\r\n      background: linear-gradient(0deg, rgba(255, 255, 255, 0.8) 0%, #FFFFFF 100%);\r\n      color: #F03C85;\r\n      padding: 0 10px;\r\n      border-radius: 12px;\r\n      display: inline-block;\r\n    }\r\n  }\r\n  .user-item{\r\n    margin-bottom: 24px;\r\n    .title{\r\n      font-size: 16px;\r\n      color: #fff;\r\n      font-weight: 600;\r\n      margin-bottom: 14px;\r\n      position: relative;\r\n      padding-left: 10px;\r\n      &::after{\r\n        content: '';\r\n        width: 3px;\r\n        position: absolute;\r\n        height: 100%;\r\n        left: 0;\r\n        background: #66d304;\r\n      }\r\n    }\r\n    .token-box{\r\n      flex-wrap: wrap;\r\n    }\r\n    .token-item{\r\n      padding: 20px;\r\n      color: #fff;\r\n      margin: 5px 0;\r\n      border-radius: 6px;\r\n      width: 49%;\r\n      .name{\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n      }\r\n      .num{\r\n        font-weight: 600;\r\n        font-size: 22px;\r\n      }\r\n      &:nth-child(1) {\r\n        background: url('~@/assets/images/item_1.png') no-repeat;\r\n        background-size: cover;\r\n        .name{\r\n          color: #FFE3C8;\r\n        }\r\n      }\r\n      &:nth-child(2) {\r\n        background: url('~@/assets/images/item_2.png') no-repeat;\r\n        background-size: cover;\r\n        .name{\r\n          color: #C3E3FE;\r\n        }\r\n      }\r\n      &:nth-child(3) {\r\n        background: url('~@/assets/images/item_2.png') no-repeat;\r\n        background-size: cover;\r\n        .name{\r\n          color: #C3E3FE;\r\n        }\r\n      }\r\n    }\r\n    .nft-box{\r\n      background: linear-gradient(-90deg, #3C3863 0%, #4A3B76 100%);\r\n      border-radius: 4px;\r\n      padding: 0 20px;\r\n      flex-wrap: wrap;\r\n      .nft-item{\r\n        width: 50%;\r\n         padding:20px 15px;\r\n        .name{\r\n          color: #9D8BD0;\r\n          font-size: 14px;\r\n          margin-bottom: 10px;\r\n        }\r\n        .num{\r\n           color: #fff;\r\n          font-size: 18px;\r\n          font-weight: 600;\r\n        }\r\n      }\r\n    }\r\n    .mynft-box{\r\n      .mynft-item{\r\n        background: rgba(255, 255, 255, 0.15);\r\n        padding: 15px;\r\n        border-radius: 4px;\r\n        margin-bottom: 10px;\r\n        img{\r\n          width: 60px;\r\n          height: 60px;\r\n          margin-right: 12px;\r\n          display: block;\r\n        }\r\n        .desc-box{\r\n          .name{\r\n            font-size: 15px;\r\n            color: #fff;\r\n            font-weight: 600;\r\n            margin-bottom: 5px;\r\n          }\r\n          .num{\r\n            font-size: 14px;\r\n            color: #a3ed3e;\r\n          }\r\n        }\r\n        .get-btn{\r\n          background: #66d304;\r\n          height: 30px;\r\n          border-radius: 15px;\r\n          padding: 0 15px;\r\n          color: #fff;\r\n          line-height: 30px;\r\n          font-size: 13px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=2bdcf2c3&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=2bdcf2c3&lang=less&scoped=true\"\n\nimport exportComponent from \"F:\\\\activeSelf\\\\freeDomVue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2bdcf2c3\"]])\n\nexport default __exports__"],"sourceRoot":""}